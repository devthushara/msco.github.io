<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invoice Generator - Matara Spice Co.</title>

  <meta name="robots" content="noindex,nofollow" />
  <link rel="canonical" href="https://mataraspice.com/" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css">

  <style>
    :root {
      --bg: #FAF6F0;
      --ink: #2A1C12;
      --accent: #9C6B3E;
      --accent-light: #eaddd0;
      --line: #E7DFD6;
      --white: #ffffff;
      --input-bg: #fffbf5;
      --input-border: #dacabf;
    }

    * { box-sizing: border-box; }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 20px; /* Reduced padding for compact view */
      line-height: 1.3; /* Tighter line height */
      font-size: 12px; /* Smaller base font for A4 density */
    }

    h1, h2, h3, h4 {
      font-family: 'Playfair Display', serif;
      margin: 0 0 0.3rem 0;
      color: var(--ink);
    }

    /* --- Form Elements --- */
    input, textarea, select {
      font-family: inherit;
      font-size: inherit;
      color: inherit;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 3px;
      padding: 2px 5px;
      width: 100%;
      transition: all 0.2s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      background: #fff;
    }

    textarea {
      resize: vertical;
      min-height: 2.2em; /* Compact textarea */
    }

    /* --- Paper Layout --- */
    .invoice-container {
      max-width: 210mm;
      min-height: 297mm;
      margin: 0 auto;
      background: var(--white);
      padding: 30px; /* Tighter internal padding */
      border-radius: 2px;
      box-shadow: 0 5px 20px rgba(42, 28, 18, 0.1);
      position: relative;
      page-break-after: avoid;
    }

    /* --- Header --- */
    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 15px;
      margin-bottom: 20px;
    }

    .brand-logo img {
      width: 100px; /* Smaller Logo */
      height: auto;
      margin-bottom: 5px;
      border-radius: 6px;
    }

    .brand-logo h1 {
      font-size: 24px; /* Compact Heading */
      color: var(--accent);
      font-weight: 700;
      line-height: 1;
    }

    .brand-logo p { margin: 0; font-size: 11px; opacity: 0.8; }

    .invoice-meta { text-align: right; }
    .invoice-meta h2 {
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .meta-grid {
      display: grid;
      grid-template-columns: auto 140px;
      gap: 4px 10px;
      align-items: center;
      text-align: right;
      font-size: 11px;
    }
    .meta-label { font-weight: 600; color: var(--accent); }

    /* --- Address Section --- */
    .address-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 20px;
    }

    .address-box h3 {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid var(--line);
      padding-bottom: 3px;
      margin-bottom: 6px;
      color: var(--accent);
    }
    
    .address-box p { margin: 0 0 2px 0; font-size: 11px; }

    /* --- Table --- */
    .table-wrapper { margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; }

    th {
      background: var(--accent);
      color: var(--white);
      text-align: left;
      padding: 6px 6px;
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
    }

    td {
      padding: 6px;
      border-bottom: 1px solid var(--line);
      vertical-align: top;
    }

    .col-desc { width: 30%; }
    .col-grade { width: 10%; }
    .col-cut { width: 10%; }
    .col-pack { width: 15%; }
    .col-qty { width: 10%; text-align: center; }
    .col-price { width: 12%; text-align: right; }
    .col-total { width: 13%; text-align: right; }
    .col-action { width: 25px; text-align: center; }

    .total-row td {
      font-weight: 700;
      font-size: 14px;
      background: #FAF6F0;
      color: var(--accent);
      border-bottom: none;
      padding-top: 10px;
      padding-bottom: 10px;
    }

    /* --- Terms & Footer --- */
    .terms-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-bottom: 20px;
      font-size: 11px;
    }
    
    .term-box h4 { font-size: 11px; margin-bottom: 4px; color: var(--accent); text-transform: uppercase; }
    .term-box p { margin: 0 0 4px 0; }
    .term-box textarea { font-size: 11px; line-height: 1.4; }

    .footer-grid {
      display: grid;
      grid-template-columns: 1.4fr 0.6fr;
      gap: 20px;
      margin-top: 10px;
      page-break-inside: avoid;
    }

    .bank-details {
      background: #FAF6F0;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid var(--line);
      font-size: 11px;
    }
    
    .bank-row { display: flex; gap: 5px; margin-bottom: 2px; }
    .bank-label { font-weight: 600; min-width: 80px; }

    .signature-box {
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
    }

    .sign-line {
      width: 100%;
      border-bottom: 1px solid var(--ink);
      margin-bottom: 10px;
      height: 35px;
    }

    /* --- Buttons --- */
    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 99px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      transition: background 0.2s;
    }
    .btn:hover { background: var(--ink); }
    
    .btn-del {
      background: transparent;
      color: #cc0000;
      font-size: 16px;
      padding: 0;
      box-shadow: none;
    }
    .btn-del:hover { background: transparent; color: #ff0000; }

    .print-controls {
      position: fixed;
      top: 15px;
      right: 15px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }

    /* WhatsApp contact button (kept visible in print) */
    .contact-wa {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 99px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      text-decoration: none;
    }

    /* Mobile responsiveness */
    @media (max-width: 720px) {
      body { padding: 10px; }
      .print-controls {
        position: static;
        margin: 10px auto 12px;
        justify-content: center;
        flex-wrap: wrap;
      }
      .invoice-container {
        padding: 16px;
        border-radius: 10px;
      }
      header {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }
      .invoice-meta { text-align: left; width: 100%; }
      .meta-grid { grid-template-columns: auto 1fr; }
    }

    /* --- PRINT STYLES --- */
    @media print {
      body {
        background: white;
        padding: 0;
        font-size: 12px; /* match screen font size for consistency */
      }
      .invoice-container {
        box-shadow: none;
        margin: 0;
        padding: 6mm 6mm 4mm 6mm; /* keep compact but balanced */
        width: 100%;
        max-width: 210mm;
        min-height: auto; /* don't force full A4 height in print */
        page-break-after: avoid;
      }
      header { margin-bottom: 20px; padding-bottom: 15px; }
      .table-wrapper { margin-bottom: 20px; }
      .terms-grid { gap: 25px; margin-bottom: 20px; }
      .footer-grid { margin-top: 10px; }
      .print-controls, .btn, .btn-del, .col-action { display: none !important; }
      /* Hide input/textarea boxes but preserve background sections like header row & bank details */
      input, textarea, select {
        border: none;
        background: transparent;
        padding: 0;
        resize: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }
      th {
        background: var(--accent) !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      .bank-details {
        background: #FAF6F0 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      @page {
        size: A4;
        margin: 8mm;
      }
    }
  </style>
</head>
<body>

  <!-- Controls -->
  <div class="print-controls">
    <button class="btn" onclick="addRow()">
      <i class="ph ph-plus"></i> Add Item
    </button>
    <button class="btn" onclick="window.print()">
      <i class="ph ph-printer"></i> Print / Save PDF
    </button>
  </div>

  <div class="invoice-container">
    
    <!-- Header -->
    <header>
      <div class="brand-logo">
        <img src="img/logo_croped.webp" alt="Matara Spice Co." onerror="this.style.display='none'">
        <h1>Matara Spice Co.</h1>
        <p>Authentic Ceylon Cinnamon<br>Malimbada, Matara, Sri Lanka</p>
        <p>Reg No: 251023325405</p>
      </div>

      <div class="invoice-meta">
        <h2>Proforma Invoice</h2>
        <div class="meta-grid">
          <span class="meta-label">Quote No:</span>
          <input id="quoteNo" type="text" value="MSC/QUO/2025/045" style="text-align: right; font-weight: 500;" oninput="updateQuoteNo()">
          
          <span class="meta-label">Date:</span>
          <input id="invoiceDate" type="date" style="text-align: right;">
          
          <span class="meta-label">Valid Until:</span>
          <input id="validUntil" type="text" value="7 Days (2025/12/11)" style="text-align: right;" oninput="updateValidity()">
          
          <span class="meta-label">Target Currency:</span>
          <select id="currencySelector" onchange="calculateTotal()" style="text-align: right; cursor: pointer;">
            <option value="USD">USD ($)</option>
            <option value="EUR">EUR (€)</option>
            <option value="GBP">GBP (£)</option>
            <option value="LKR">LKR (Rs)</option>
            <option value="AUD">AUD ($)</option>
            <option value="JPY">JPY (¥)</option>
            <option value="SGD">SGD ($)</option>
          </select>

          <span class="meta-label">Exchange Rate:</span>
          <input type="number" id="exchangeRate" value="1.00" step="0.01" oninput="calculateTotal()" style="text-align: right;" placeholder="1 USD = ?">
        </div>
      </div>
    </header>

    <!-- Address Details -->
    <section class="address-section">
      <!-- Static Seller Details -->
      <div class="address-box">
        <h3>Seller (Exporter)</h3>
        <strong>Matara Spice Co.</strong>
        <p>Malimbada, Matara, Sri Lanka</p>
        <p>
          <a class="contact-wa" href="https://wa.me/6594252874?text=Hi%20Matara%20Spice%20Co.%20I%20have%20a%20question%20about%20this%20invoice." target="_blank" rel="noopener">
            <i class="ph ph-whatsapp-logo"></i> Reach us on WhatsApp
          </a>
        </p>
        <p><i class="ph ph-globe"></i> www.mataraspice.com</p>
      </div>
      
      <!-- Editable Buyer Details -->
      <div class="address-box">
        <h3>Buyer (Bill To)</h3>
        <input type="text" value="" placeholder="Client / Buyer Name" style="font-weight: 700; font-size: 1.1em; margin-bottom: 2px;">
        <textarea rows="5" placeholder="Buyer address, tax numbers, contact details"></textarea>
      </div>
    </section>

    <!-- Product Table -->
    <div class="table-wrapper">
      <table id="invoiceTable">
        <thead>
          <tr>
            <th class="col-desc">Description</th>
            <th class="col-grade">Grade</th>
            <th class="col-cut">Cut Size</th>
            <th class="col-pack">Packaging</th>
            <th class="col-qty">Qty (kg)</th>
            <th class="col-price">Unit Price (USD)</th>
            <th class="col-total">Total (USD)</th>
            <th class="col-action"></th>
          </tr>
        </thead>
        <tbody>
          <!-- Dynamic Rows -->
          <tr class="item-row">
            <td><textarea rows="2">Ceylon Cinnamon (True Cinnamon)</textarea></td>
            <td><input type="text" value="" placeholder="Grade"></td>
            <td><input type="text" value="" placeholder="Cut Size"></td>
            <td><input type="text" value="" placeholder="Packaging"></td>
            <td><input type="number" class="qty" value="0" oninput="calculateTotal()"></td>
            <td><input type="number" class="price" value="0" step="0.01" oninput="calculateTotal()"></td>
            <td style="text-align: right; padding-top: 8px;">
              <span class="row-total">0.00</span>
            </td>
            <td class="col-action">
              <button class="btn btn-del" onclick="deleteRow(this)"><i class="ph ph-trash"></i></button>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="6" style="text-align: right; padding-right: 10px;">Total Amount (<span id="totalCurrencyLabel">USD</span>):</td>
            <td style="text-align: right;"><span id="grandTotal">0.00</span></td>
            <td class="col-action"></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Technical Details Grid -->
    <section class="terms-grid">
      <!-- Left Column -->
      <div>
        <div class="term-box">
          <h4><i class="ph ph-package"></i> Packaging Details</h4>
          <textarea rows="4" style="width:100%;">1. 1 kg standard food-grade poly packs
2. 25 kg per master carton
3. Standard export corrugated cartons
4. Labeling: Product name, grade, weight, batch no, origin</textarea>
        </div>
        
        <div class="term-box" style="margin-top: 15px;">
          <h4><i class="ph ph-certificate"></i> Certifications Provided</h4>
          <textarea rows="4" style="width:100%;">1. Phytosanitary Certificate
2. Certificate of Origin (COO)
3. Quality Certificate (Moisture)
4. Fumigation Certificate (If requested)
5. SGS Inspection (Optional - Extra Cost)</textarea>
        </div>
      </div>

      <!-- Right Column -->
      <div>
        <div class="term-box">
          <h4><i class="ph ph-boat"></i> Shipping Terms</h4>
          <div style="display:grid; grid-template-columns: 90px 1fr; gap: 2px; font-size: 11px;">
            <strong>Incoterm:</strong> <input type="text" value="" placeholder="e.g. FOB / CIF / CNF">
            <strong>Port Load:</strong> <input type="text" value="" placeholder="Port of loading">
            <strong>Port Dest:</strong> <input type="text" value="" placeholder="Destination port">
            <strong>Process:</strong> <input type="text" value="" placeholder="Production / processing time">
            <strong>Transit:</strong> <input type="text" value="" placeholder="Transit time">
            <strong>Insurance:</strong> <input type="text" value="" placeholder="Insurance responsibility">
          </div>
        </div>

        <div class="term-box" style="margin-top: 15px;">
          <h4><i class="ph ph-money"></i> Payment Terms</h4>
          <p><strong>Preferred:</strong> Letter of Credit (LC)</p>
          <p><strong>Alternative:</strong> 50% Advance / 50% Balance before shipment</p>
          <p style="font-style: italic; opacity: 0.8; margin-top: 4px; font-size: 10px;">
            (Inspection photos and weight checks provided before final payment)
          </p>
        </div>
      </div>
    </section>

    <!-- Footer / Banking -->
    <div class="footer-grid">
      <div class="bank-details">
        <div style="display:flex; justify-content: space-between; align-items:center; margin-bottom:6px;">
          <h4 style="margin:0;"><i class="ph ph-bank"></i> Bank Details</h4>
          <select id="bankSelector" style="width:auto; font-size:10px; padding:2px 6px;">
            <option value="HNB">HNB - Sri Lanka</option>
            <option value="DBS">DBS - Singapore</option>
          </select>
        </div>
        <div class="bank-row">
          <span class="bank-label">Bank Name:</span> <span id="bankName">Hatton National Bank PLC</span>
        </div>
        <div class="bank-row">
          <span class="bank-label">Acc Name:</span> <span id="bankAccName">Ratk Ranawaka</span>
        </div>
        <div class="bank-row">
          <span class="bank-label">Acc No:</span> <span id="bankAccNo">042020474661</span>
        </div>
        <div class="bank-row">
          <span class="bank-label">Branch:</span> <span id="bankBranch">Matara Branch (Code: 042)</span>
        </div>
        <div class="bank-row">
          <span class="bank-label">SWIFT/BIC:</span> <span id="bankSwift">HBLILKLX</span>
        </div>
      </div>

      <div class="signature-box">
        <div class="sign-line"></div>
        <strong style="display:block; margin-bottom: 2px;">Thushara Ranawaka</strong>
        <span>Director - International Operations</span>
        <p style="margin:0;">Matara Spice Co., Sri Lanka</p>
      </div>
    </div>
    
    <div id="footerNote" style="margin-top: 20px; border-top: 1px solid var(--line); padding-top: 8px; font-size: 10px; color: #888; text-align: center;">
      <p>This quotation is not a contract; order confirmation is required. Prices are valid for 7 days and may vary based on auction rates. Final invoice will reflect exact packed weight.</p>
    </div>

  </div>

  <!-- JavaScript Logic -->
  <script>
    const currencySymbols = {
      'USD': '$',
      'EUR': '€',
      'GBP': '£',
      'LKR': 'Rs',
      'AUD': '$',
      'JPY': '¥',
      'SGD': '$'
    };

    function calculateTotal() {
      let usdSubTotal = 0;
      const rows = document.querySelectorAll('.item-row');
      const exchangeRate = parseFloat(document.getElementById('exchangeRate').value) || 1;
      const selectedCurrency = document.getElementById('currencySelector').value;
      const symbol = currencySymbols[selectedCurrency] || '$';

      // Update Currency Label in Footer
      document.getElementById('totalCurrencyLabel').textContent = selectedCurrency;

      // 1. Calculate USD Subtotals per row
      rows.forEach(row => {
        const qty = parseFloat(row.querySelector('.qty').value) || 0;
        const price = parseFloat(row.querySelector('.price').value) || 0;
        const totalUSD = qty * price;
        
        // Show row total in USD (Base)
        row.querySelector('.row-total').textContent = totalUSD.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        
        usdSubTotal += totalUSD;
      });

      // 2. Calculate Final Converted Total
      const grandTotalConverted = usdSubTotal * exchangeRate;

      // 3. Update Grand Total Display (numeric only; currency in label cell)
      document.getElementById('grandTotal').textContent = grandTotalConverted.toLocaleString('en-US', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }

    // --- Valid Until Auto-Calculation ---
    function updateValidity() {
      const dateInput = document.getElementById('invoiceDate');
      const out = document.getElementById('validUntil');
      const footer = document.getElementById('footerNote');
      if (!dateInput || !out) return;

      const base = dateInput.value ? new Date(dateInput.value) : null;
      // Read days from the beginning of the field (e.g. "7 Days (2025/12/11)")
      const daysMatch = out.value.match(/^(\d+)/);
      const days = daysMatch ? parseInt(daysMatch[1], 10) : NaN;
      if (!base || isNaN(days) || days < 0) {
        out.value = '';
        if (footer) {
          footer.querySelector('p').textContent = 'This quotation is not a contract; order confirmation is required. Final invoice will reflect exact packed weight.';
        }
        return;
      }

      const target = new Date(base);
      target.setDate(target.getDate() + days);

      const yyyy = target.getFullYear();
      const mm = String(target.getMonth() + 1).padStart(2, '0');
      const dd = String(target.getDate()).padStart(2, '0');

      out.value = `${days} Days (${yyyy}/${mm}/${dd})`;

      if (footer) {
        footer.querySelector('p').textContent = `This quotation is not a contract; order confirmation is required. Prices are valid for ${days} days and may vary based on auction rates. Final invoice will reflect exact packed weight.`;
      }
    }

    // --- Quote Number Auto-Generation ---
    function updateQuoteNo() {
      const dateInput = document.getElementById('invoiceDate');
      const quoteInput = document.getElementById('quoteNo');
      if (!dateInput || !quoteInput) return;

      const baseDate = dateInput.value ? new Date(dateInput.value) : null;
      if (!baseDate) return;

      const year = baseDate.getFullYear();

      // Read any digits at the end of the current quote input, default to 1
      const raw = quoteInput.value.trim();
      const match = raw.match(/(\d+)$/);
      const lastNumber = match ? match[1] : '1';
      const padded = lastNumber.padStart(3, '0');

      quoteInput.value = `MSC/QUO/${year}/${padded}`;
    }

    // Auto-resize helper for textareas so print doesn't cut content
    function autoResizeTextarea(el) {
      if (!el) return;
      el.style.height = 'auto';
      el.style.height = (el.scrollHeight + 2) + 'px';
    }

    function addRow() {
      const tbody = document.querySelector('#invoiceTable tbody');
      const newRow = document.createElement('tr');
      newRow.className = 'item-row';
      newRow.innerHTML = `
        <td><textarea rows="2" oninput="autoResizeTextarea(this)">New Item</textarea></td>
        <td><input type="text" value=""></td>
        <td><input type="text" value=""></td>
        <td><input type="text" value=""></td>
        <td><input type="number" class="qty" value="0" oninput="calculateTotal()"></td>
        <td><input type="number" class="price" value="0" step="0.01" oninput="calculateTotal()"></td>
        <td style="text-align: right; padding-top: 8px;">
          <span class="row-total">0.00</span>
        </td>
        <td class="col-action">
          <button class="btn btn-del" onclick="deleteRow(this)"><i class="ph ph-trash"></i></button>
        </td>
      `;
      tbody.appendChild(newRow);
    }

    function deleteRow(btn) {
      const rows = document.querySelectorAll('.item-row');
      if(rows.length > 1) {
        btn.closest('tr').remove();
        calculateTotal();
      } else {
        alert("You must have at least one item.");
      }
    }

    // --- Bank selector (HNB vs DBS) ---
    function updateBankDetails() {
      const selector = document.getElementById('bankSelector');
      if (!selector) return;

      const bankName = document.getElementById('bankName');
      const bankAccName = document.getElementById('bankAccName');
      const bankAccNo = document.getElementById('bankAccNo');
      const bankBranch = document.getElementById('bankBranch');
      const bankSwift = document.getElementById('bankSwift');

      if (selector.value === 'DBS') {
        if (bankName) bankName.textContent = 'DBS Bank';
        if (bankAccName) bankAccName.textContent = 'RATK Ranawaka';
        if (bankAccNo) bankAccNo.textContent = '0060224539';
        if (bankBranch) bankBranch.textContent = 'Singapore';
        if (bankSwift) bankSwift.textContent = 'DBSSSGSG';
      } else {
        if (bankName) bankName.textContent = 'Hatton National Bank PLC';
        if (bankAccName) bankAccName.textContent = 'Ratk Ranawaka';
        if (bankAccNo) bankAccNo.textContent = '042020474661';
        if (bankBranch) bankBranch.textContent = 'Matara Branch (Code: 042)';
        if (bankSwift) bankSwift.textContent = 'HBLILKLX';
      }
    }

    window.onload = function () {
      calculateTotal();

      const dateInput = document.getElementById('invoiceDate');
      const quoteInput = document.getElementById('quoteNo');

      // If no date set, default to today (YYYY-MM-DD)
      if (dateInput && !dateInput.value) {
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        dateInput.value = `${yyyy}-${mm}-${dd}`;
      }

      // Compute dependent fields from the (possibly defaulted) date
      updateValidity();
      updateQuoteNo();

      dateInput?.addEventListener('change', function() {
        updateValidity();
        updateQuoteNo();
      });

      // Init and bind bank selector
      updateBankDetails();
      document.getElementById('bankSelector')?.addEventListener('change', updateBankDetails);

      // Auto-resize all existing textareas based on their initial content
      document.querySelectorAll('textarea').forEach(autoResizeTextarea);
    };
  </script>

</body>
</html>